import{N as S,F as A}from"./Footer-b98c2838.js";import{i as h}from"./axios-e04a9f32.js";import{d as R,r as u,o as j,k as q,u as z,_ as H,i as F,a as e,c as s,j as $,b as t,g as C,f as m,t as _,F as w,e as Y,h as G}from"./index-dc10c74a.js";import{u as J}from"./useFavs-c702a860.js";import{u as K}from"./useTo-872da6cd.js";import O from"books.svg";import Q from"check.svg";import U from"eye.svg";import"menu.svg";import"search.svg";import"logo.png";const W=(a,r)=>({urlCompressed:a.replace("/upload/",`/upload/q_${r}/`)}),X=R({name:"manga-title",components:{Nav:S,Footer:A},setup(){const a=q(),r=z(),l=u(),c=u(),f=u(),k=u(),p=u([]),v=u(),{checkFavs:n,addToFavs:y,removeFav:N,getFavs:T,isFav:I}=J(),{toViewer:V}=K(r),E=async()=>{const{data:o}=await h.get(`/manga/${a.params.id}`);c.value=o.data,await M(),l.value.forEach(async(i,d)=>{const g=await b(i._id);g&&(l.value[d]={...l.value[d],pageImage:g.image})})},b=async o=>{const{data:i}=await h.get(`/pages/chapter/${o}`);return i.data.pages[0]},M=async()=>{const{data:o}=await h.get(`/chapter/manga/${c.value._id}`);l.value=o.data},B=async()=>{const{data:o}=await h.get(`/author/${c.value.author}`);v.value=o.data},D=()=>{f.value.style.backgroundImage=`url(${c.value.images.cover})`,k.value.style.background=`url(${c.value.images.background}) rgba(0, 0, 0) `,setTimeout(()=>{p.value.forEach((o,i)=>{const d=l.value[i].pageImage,{urlCompressed:g}=W(d,5);setTimeout(()=>{o.style.backgroundImage=`url(${g})`},1200*i)})},2400)},L=o=>{const i=new Date(o),d=i.getDate(),g=i.toLocaleString("es",{month:"long"}),P=i.getFullYear();return`${d} ${g} ${P}`};return j(async()=>{await E(),await B(),T(),n(c.value._id),D()}),{manga:c,portrait:f,pageChapter:p,mangaTitle:k,author:v,chapters:l,formattedPremiere:L,getPagesbyChapter:b,addToFavs:y,isFav:I,removeFav:N,toViewer:V}}}),Z={class:"content"},x={ref:"mangaTitle",class:"manga-title"},aa={key:0,class:"manga-title__main"},ta={class:"manga-title__left"},ea={ref:"portrait",class:"manga-title__portrait"},sa=t("img",{class:"books-icon",src:O},null,-1),na=t("img",{class:"books-icon",src:Q},null,-1),oa={class:"manga-title__right"},ia={class:"manga-title__header"},ra={class:"manga-title__name"},la={class:"manga-title__author"},ca={class:"manga-title__desc"},ma=t("span",{class:"manga-title__argument"},"Argumento",-1),_a={class:"manga-title__text"},da={class:"manga-title__content"},ga={key:0,class:"manga-title__chapters"},ua=G('<div class="manga-title__title-chapters"><h3 class="manga-title__title-list">Lista de Cap√≠tulos</h3><span class="manga-title__title-views"><img src="'+U+'" class="manga-title__title-icon"><span class="manga-title__title-number"> 987 </span></span></div>',1),pa={key:0,class:"manga-title__title-state"},va={key:1,class:"manga-title__title-state"},ha={key:2,class:"manga-title__title-state"},fa=["onClick"],ka={class:"manga-title__card-content"},ya={key:0,class:"manga-title__card-number"},ba={key:1,class:"manga-title__card-number"},Fa={key:2,class:"manga-title__card-number"},$a={class:"manga-title__card-title"},Ca={class:"manga-title__card-date"},wa=t("div",{class:"manga-title__social-media"},null,-1);function Na(a,r,l,c,f,k){const p=F("Nav"),v=F("Footer");return e(),s(w,null,[$(p),t("div",Z,[t("section",x,[a.author?(e(),s("div",aa,[t("div",ta,[t("div",ea,null,512),a.isFav?m("",!0):(e(),s("a",{key:0,onClick:r[0]||(r[0]=n=>a.addToFavs(a.manga._id)),class:"manga-title__fav"},[C("Enviar a favoritos "),sa])),a.isFav?(e(),s("a",{key:1,onClick:r[1]||(r[1]=n=>a.removeFav(a.manga._id)),class:"manga-title__fav"},[C("Favorito "),na])):m("",!0)]),t("div",oa,[t("div",ia,[t("h2",ra,_(a.manga.title),1),t("h3",la,_(a.author.name),1)]),t("div",ca,[ma,t("p",_a,_(a.manga.description),1)])])])):m("",!0)],512),t("div",da,[a.manga?(e(),s("div",ga,[ua,a.manga.state==="hiatus"?(e(),s("h4",pa," El manga se encuentra en Hiatus ")):m("",!0),a.manga.state==="emission"?(e(),s("h4",va," Cada semana un nuevo capitulo ")):m("",!0),a.manga.state==="complete"?(e(),s("h4",ha," Manga finalizado ")):m("",!0),(e(!0),s(w,null,Y(a.chapters,n=>(e(),s("div",{class:"manga-title__card",onClick:y=>a.toViewer(n._id)},[n.pageImage?(e(),s("div",{key:0,ref_for:!0,ref:"pageChapter",class:"manga-title__card-image"},null,512)):m("",!0),t("div",ka,[Number(n.number)<10?(e(),s("span",ya,"#00"+_(n.number),1)):Number(n.number)<100?(e(),s("span",ba,"#0"+_(n.number),1)):(e(),s("span",Fa,"#"+_(n.number),1)),t("span",$a,_(n.title),1),t("span",Ca,_(a.formattedPremiere(n.premiere)),1)])],8,fa))),256))])):m("",!0),wa])]),$(v)],64)}const Ra=H(X,[["render",Na]]);export{Ra as default};
